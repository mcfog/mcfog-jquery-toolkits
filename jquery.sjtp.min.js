/**
 * Simple Javascript Template Parser
 * @author McFog <mcfogW@gmail.com>
 * @license MIT License
 * 
 * Include
 * Cross-Browser Split 1.0.1
 * (c) Steven Levithan <stevenlevithan.com>; MIT License
 * An ECMA-compliant, uniform cross-browser split method
 */

(function($){var h;if(!h){h=function(a,b,c){if(Object.prototype.toString.call(b)!=="[object RegExp]"){return h._nativeSplit.call(a,b,c)}var d=[],lastLastIndex=0,flags=(b.ignoreCase?"i":"")+(b.multiline?"m":"")+(b.sticky?"y":""),b=RegExp(b.source,flags+"g"),separator2,match,lastIndex,lastLength;a=a+"";if(!h._compliantExecNpcg){separator2=RegExp("^"+b.source+"$(?!\\s)",flags)}if(c===undefined||+c<0){c=Infinity}else{c=Math.floor(+c);if(!c){return[]}}while(match=b.exec(a)){lastIndex=match.index+match[0].length;if(lastIndex>lastLastIndex){d.push(a.slice(lastLastIndex,match.index));if(!h._compliantExecNpcg&&match.length>1){match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++){if(arguments[i]===undefined){match[i]=undefined}}})}if(match.length>1&&match.index<a.length){Array.prototype.push.apply(d,match.slice(1))}lastLength=match[0].length;lastLastIndex=lastIndex;if(d.length>=c){break}}if(b.lastIndex===match.index){b.lastIndex++}}if(lastLastIndex===a.length){if(lastLength||!b.test("")){d.push("")}}else{d.push(a.slice(lastLastIndex))}return d.length>c?d.slice(0,c):d};h._compliantExecNpcg=/()??/.exec("")[1]===undefined;h._nativeSplit=String.prototype.split}String.prototype.split=function(a,b){return h(this,a,b)};var j={'render':function(a,b,c){var d=this;c=$.extend({tagRE:/(<<([\s\S]+?)>>)/},c);if('string'!==typeof a){a=$(a).html()}return d.html(j.parse(a,c).call(d,b))},'parse':function(a,b){var c=a.split(b.tagRE);var d=['var $container=this,htm=[],echo=function(){htm.push.apply(htm, arguments)};with(context){'];var e=0,_loop=0,curTag=[];while(c.length>0){var f=c.shift();if(f.length==0)continue;if(b.tagRE.test(f)){f=c.shift();var t=f.substr(0,1);if(t==':'){var g=f.substr(1);d.push('echo('+g+');');continue}else if(t=='~'){var g=f.substr(1);d.push(g+';');continue}var g=/^\s*?([\/\w]+)(?:\s+(.*))?$/g.exec(f);switch(g[1]){case'if':e+=1;curTag.unshift('if');d.push('if('+g[2]+'){');break;case'elif':d.push('}else if('+g[2]+'){');break;case'else':switch(curTag[0]){case'if':d.push('}else{');break;default:return false}break;case'/if':e-=1;if(e<0)return false;if('if'!=curTag.shift())return false;d.push('}');break;case'loop':_loop+=1;curTag.unshift('loop');g=g[2].split(/\s+/);if(g.length<2){return false}else if(g.length==2){d.push('for(k in '+g[0]+') {if(!'+g[0]+'.hasOwnProperty(k))continue;var '+g[1]+'='+g[0]+'[k];')}else if(g.length==3){d.push('for('+g[1]+' in '+g[0]+') {if(!'+g[0]+'.hasOwnProperty('+g[1]+'))continue;var '+g[2]+'='+g[0]+'['+g[1]+'];')}else{return false}break;case'/loop':_loop-=1;if('loop'!=curTag.shift())return false;if(_loop<0)return false;d.push('}');break;default:return false}}else{d.push('echo("'+f.replace('"','\\"').replace('\\','\\\\').replace(/[\r\n]/g,'\\n')+'");')}}d.push('}return htm.join("");');return new Function('context',d.join(''))}};$.fn.render=j.render})(jQuery);
